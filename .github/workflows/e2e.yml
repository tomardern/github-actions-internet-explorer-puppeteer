on: push

jobs:
  translation_check:
    runs-on: windows-2019
    name: Init
    steps:
      - name: Checkout local repo on this branch
        uses: actions/checkout@v2
        with:
          ref: ${{ github.event.pull_request.head.ref }}
          path: ./

      - name: Get npm cache directory
        id: npm-cache
        run: |
          echo "::set-output name=dir::$(npm config get cache)"

      - uses: actions/cache@v2
        with:
          path: ${{ steps.npm-cache.outputs.dir }}
          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-node-

      - name: NPM install
        run: |
          npm install

      - name: Install FFMPEG
        run: choco install ffmpeg

      - name: Test
        timeout-minutes: 5
        run: |
          npm run testcafe:ie
